{"version":3,"file":"PaneItem-47ff6ab4.js","sources":["../../src/desk/components/MissingSchemaType.tsx","../../src/desk/components/paneItem/PaneItem.tsx"],"sourcesContent":["import {WarningOutlineIcon} from '@sanity/icons'\nimport {SanityDocument} from '@sanity/types'\nimport React from 'react'\nimport {GeneralPreviewLayoutKey, SanityDefaultPreview} from 'sanity'\n\nexport interface MissingSchemaTypeProps {\n  layout?: GeneralPreviewLayoutKey\n  value: SanityDocument\n}\n\nconst getUnknownTypeFallback = (id: string, typeName: string) => ({\n  title: (\n    <em>\n      No schema found for type <code>{typeName}</code>\n    </em>\n  ),\n  subtitle: (\n    <em>\n      Document: <code>{id}</code>\n    </em>\n  ),\n  media: () => <WarningOutlineIcon />,\n})\n\nexport function MissingSchemaType(props: MissingSchemaTypeProps) {\n  const {layout, value} = props\n\n  return (\n    <SanityDefaultPreview {...getUnknownTypeFallback(value._id, value._type)} layout={layout} />\n  )\n}\n","import {FolderIcon, ChevronRightIcon, DocumentIcon} from '@sanity/icons'\nimport {isSanityDocument, PreviewValue, SanityDocument, SchemaType} from '@sanity/types'\nimport {CardProps, Text} from '@sanity/ui'\nimport React, {ReactNode, useCallback, useEffect, useMemo, useState} from 'react'\nimport {MissingSchemaType} from '../MissingSchemaType'\nimport {usePaneRouter} from '../paneRouter'\nimport {PaneItemPreview} from './PaneItemPreview'\nimport {\n  FIXME,\n  GeneralPreviewLayoutKey,\n  PreviewCard,\n  SanityDefaultPreview,\n  useDocumentPresence,\n  useDocumentPreviewStore,\n  useSchema,\n} from 'sanity'\n\ninterface PaneItemProps {\n  id: string\n  layout?: GeneralPreviewLayoutKey\n  icon?: React.ComponentType<any> | false\n  pressed?: boolean\n  selected?: boolean\n  title?: string\n  value?: PreviewValue | SanityDocument\n  schemaType?: SchemaType\n  margin?: CardProps['margin']\n  marginBottom?: CardProps['marginBottom']\n  marginTop?: CardProps['marginTop']\n}\n\n/**\n * Return `false` if we explicitly disable the icon.\n * Otherwise return the passed icon or the schema type icon as a backup.\n */\nexport function getIconWithFallback(\n  icon: React.ComponentType<any> | false | undefined,\n  schemaType: SchemaType | undefined,\n  defaultIcon: React.ComponentType<any>,\n): React.ComponentType<any> | false {\n  if (icon === false) {\n    return false\n  }\n\n  return icon || (schemaType && schemaType.icon) || defaultIcon || false\n}\n\nexport function PaneItem(props: PaneItemProps) {\n  const {\n    icon,\n    id,\n    layout = 'default',\n    pressed,\n    schemaType,\n    selected,\n    title,\n    value,\n    margin,\n    marginBottom,\n    marginTop,\n  } = props\n  const schema = useSchema()\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {ChildLink} = usePaneRouter()\n  const documentPresence = useDocumentPresence(id)\n  const hasSchemaType = Boolean(schemaType && schemaType.name && schema.get(schemaType.name))\n  const [clicked, setClicked] = useState<boolean>(false)\n\n  const preview = useMemo(() => {\n    if (value && isSanityDocument(value)) {\n      if (!schemaType || !hasSchemaType) {\n        return <MissingSchemaType value={value} />\n      }\n\n      return (\n        <PaneItemPreview\n          documentPreviewStore={documentPreviewStore}\n          icon={getIconWithFallback(icon, schemaType, DocumentIcon)}\n          layout={layout}\n          schemaType={schemaType}\n          value={value}\n          presence={documentPresence}\n        />\n      )\n    }\n\n    return (\n      <SanityDefaultPreview\n        status={\n          <Text muted>\n            <ChevronRightIcon />\n          </Text>\n        }\n        icon={getIconWithFallback(icon, schemaType, FolderIcon)}\n        layout={layout}\n        title={title}\n      />\n    )\n  }, [\n    documentPreviewStore,\n    hasSchemaType,\n    icon,\n    layout,\n    schemaType,\n    title,\n    value,\n    documentPresence,\n  ])\n\n  const Link = useMemo(\n    () =>\n      function LinkComponent(linkProps: {children: ReactNode}) {\n        return <ChildLink {...linkProps} childId={id} />\n      },\n    [ChildLink, id],\n  )\n\n  const handleClick = useCallback((e: React.MouseEvent<HTMLElement>) => {\n    if (e.metaKey) {\n      setClicked(false)\n      return\n    }\n\n    setClicked(true)\n  }, [])\n\n  // Reset `clicked` state when `selected` prop changes\n  useEffect(() => setClicked(false), [selected])\n\n  return (\n    <PreviewCard\n      __unstable_focusRing\n      as={Link as FIXME}\n      data-as=\"a\"\n      data-ui=\"PaneItem\"\n      margin={margin}\n      marginBottom={marginBottom}\n      marginTop={marginTop}\n      onClick={handleClick}\n      padding={2}\n      pressed={pressed}\n      radius={2}\n      selected={selected || clicked}\n      sizing=\"border\"\n      tabIndex={-1}\n      tone=\"inherit\"\n    >\n      {preview}\n    </PreviewCard>\n  )\n}\n"],"names":["getUnknownTypeFallback","id","typeName","title","children","jsx","subtitle","media","WarningOutlineIcon","MissingSchemaType","props","layout","value","SanityDefaultPreview","_id","_type","getIconWithFallback","icon","schemaType","defaultIcon","PaneItem","pressed","selected","margin","marginBottom","marginTop","schema","useSchema","documentPreviewStore","useDocumentPreviewStore","ChildLink","usePaneRouter","documentPresence","useDocumentPresence","hasSchemaType","Boolean","name","get","clicked","setClicked","useState","preview","useMemo","isSanityDocument","PaneItemPreview","DocumentIcon","presence","status","Text","muted","ChevronRightIcon","FolderIcon","Link","LinkComponent","linkProps","childId","handleClick","useCallback","e","metaKey","useEffect","PreviewCard","__unstable_focusRing","as","onClick","padding","radius","sizing","tabIndex","tone"],"mappings":"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"}